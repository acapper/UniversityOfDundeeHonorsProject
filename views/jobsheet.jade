extends layout/layout

include partials/jobsheet-section
include partials/jobsheet-sidenav

block content
	.uk-grid-large(uk-grid).uk-margin-small-bottom
		.uk-invisible(class="uk-width-1-4@m")
		if jobsheet != null
			- var date = moment(new Date(jobsheet.created)).format('MMM Do YYYY')
			// https://stackoverflow.com/questions/10073699/pad-a-number-with-leading-zeros-in-javascript
			- var n = jobsheet._id
			- var width = 8
			- var z = '0';
			- n = n + '';
			- n = n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
			h1#title ##{n} - #{jobsheet.data.customerdetailsname.value} (#{date})
		else
			h1 New Job Sheet
			
	form#jobsheetform.uk-margin-large-bottom
		.uk-grid-large(uk-grid)
			+sidenav(jobsheet, staff)
			
			div(class="uk-width-expand@m")
				ul(uk-accordion="multiple: true")
					each section in layout
						+jobsheet-section(section, jobsheet, partlayout, sitevisitlayout)
		
	if jobsheet != null
		p#id.uk-hidden
			| #{jobsheet._id}

	script(src='/javascripts/dom-to-blob.min.js')
	script(src='/javascripts/job-sheet.js')
	script(src='/javascripts/problem-other.js')